language: cpp
dist: bionic

addons:
  apt:
    packages:
      - doxygen
      - graphviz

script:
  - set -e
  - cmake .
  - cmake --build .
  - cmake --build . --target test
  - cmake --build . --target doc
  - cmake --build . --target package
deploy:
  - provider: bintray
    file: bintray.json
    user: khatrox
    key: ${BINTRAY_API}
    skip_cleanup: true

  - provider: pages
    github_token: ${GITHUB_TOKEN}
    skip_cleanup: true
    local_dir: html
    on:
      branch: master